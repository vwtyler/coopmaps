---
title: "National NRECA Network"
author: "Tyler Jackson"
date: "5/27/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(mapview)
library(rgdal)
library(sf)
library(ggplot2)
library(stringr)
library(scales)
library(igraph)
library(ggmap)
library(maps)
library(ggthemes)
library(mapdata)
library(tidyverse)
library(ggrepel)
```


Bring in the (Geocoded) National Data and the Edges
```{r}
# creating an object for national nodes

nat_nodes <- read.csv("./data/natl_nodes-geocoded.csv", stringsAsFactors = F)

# cleaning up data and clearing out extra variable of lng

nat_nodes$lon <- nat_nodes$lng
nat_nodes$lng <- NULL
nat_nodes

# creating an object for national edges

nat_edges <- read.csv("./data/natl_edges.csv", stringsAsFactors = F)
nat_edges
```

## Interactive Maps
```{r}
nat_nodes.sf <- st_as_sf(x = nat_nodes[!is.na(nat_nodes$lat),], 
                        coords = c("lon", "lat"),
                        crs = "+proj=longlat +datum=WGS84")
mapview(nat_nodes.sf)

``` 

```{r}
graph1 <- graph.data.frame(nat_edges, directed = T)
graph1
summary(graph1)

# adding attributes of the nodes to the graph
nat_nodes$idch <- as.character(nat_nodes$ID)
id <- match(V(graph1)$name, nat_nodes$idch)
V(graph1)$lat <- nat_nodes$lat[id]
V(graph1)$lon <- nat_nodes$lon[id]
V(graph1)$cat1 <- as.character(nat_nodes$cat1[id])
V(graph1)$cat2 <- as.character(nat_nodes$cat2[id])
V(graph1)$cat3 <- as.character(nat_nodes$cat3[id])
V(graph1)$fullname <- as.character(nat_nodes$Label[id])
V(graph1)$state <- as.character(nat_nodes$State[id])

``` 


Turn it into a graph

Bring in node attributes

Calculate some graph statistics

Make some graphs
