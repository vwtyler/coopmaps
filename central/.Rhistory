data = coops[coops$ID == 14,],
size = 3, color = "blue") +
labs(title = "Marlboro Electric Cooperative Territory") +
geom_label_repel(aes(lon, lat, label = Label),
box.padding   = 1,
point.padding = 1,
segment.color = 'black',
data = coops[coops$ID == 14,]) +
guides(fill = "none") +
theme_map()
coops[coops$ID == 10,]
marl_nodes <- as.data.frame(cbind(V(g.dist)$long,V(g.dist)$lat))
marl_nodes$cat2 <- V(g.dist)$cat2
marl_nodes$cat1 <- V(g.dist)$cat1
marl_nodes$cat3 <- V(g.dist)$cat3
marl_nodes$name <- V(g.dist)$fullname
marl_nodes$state <- V(g.dist)$state
head(marl_nodes)
sc_counties +
geom_sf(data = territories[territories$name == "Marlboro Territorial",],
inherit.aes = FALSE, fill = "blue", alpha = .4) +
coord_sf(datum=NA) +
geom_point(aes(V1, V2, color = cat2),
data = marl_nodes %>%
filter(state == "SC") %>%
filter(cat1 == "First Tier" | cat2 == "Program"| cat2 == "Other"),
size = 3) +
geom_point(aes(V1, V2),
data = marl_nodes %>%
filter(state == "SC") %>%
filter(cat1 == "First Tier" | cat2 == "Program"| cat2 == "Other"),
size = 3, stroke = 1, shape = 21) +
labs(title = "Marlboro Electric Cooperative and Territory",
subtitle = "with programs in their network",
color = "Node Type") +
theme_map()
sc_counties +
geom_sf(data = territories,
inherit.aes = FALSE, aes(fill = name), alpha = .6) +
coord_sf(datum=NA) +
geom_point(aes(lon, lat, fill = Label),
data = coops %>%
filter(cat1 == "First Tier"),
size = 3, color = "black", stroke = 1, shape = 21) +
guides(fill = "none", color = "none") +
labs(title = "South Carolina Cooperative Service Territories", subtitle = "with Central Distribution Offices") +
theme_map()
sc_counties +
geom_sf(data = territories,
inherit.aes = FALSE, aes(fill = name),
alpha = .6) +
coord_sf(datum=NA) +
geom_point(aes(lon, lat, color = cat2),
data = coops %>%
filter(State == "SC") %>%
filter(cat1 == "First Tier" | cat2 == "Other" | cat2 == "Program"),
size = 3) +
geom_point(aes(lon, lat),
data = coops %>%
filter(State == "SC") %>%
filter(cat1 == "First Tier" | cat2 == "Other" | cat2 == "Program"),
size = 3, color = "black", stroke = 1,
shape = 21) +
guides(fill = "none", color = "legend") +
labs(title = "South Carolina Cooperative Service Territories", subtitle = "with Central Distribution Offices & Programs", color = "Node Type") +
theme_map()
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
main = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
knitr::opts_chunk$set(echo = TRUE)
library(mapview)
library(rgdal)
library(sf)
library(ggplot2)
library(stringr)
library(scales)
#loading the package:
library(igraph)
library(ggmap)
library(maps)
library(ggthemes)
library(mapdata)
library(tidyverse)
library(ggrepel)
library(networkD3)
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
main = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
? plot
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
V(g.state)[cat3 == "GandT"]
V(g.state)[cat3 == "GandT"]$name
V(g.state)[cat3 == "GandT"]$fullname
V(g.state)[cat3 == "GandT"]$fullname
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = V(g.state)[cat3 == "GandT"]$fullname,
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
V(g.state)[cat3 == "GandT"]$fullname
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name <= 2, V(g.state)$fullname, NA),
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
V(g.state)[cat3 == "GandT"]$fullname
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 2, V(g.state)$fullname, NA),
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
V(g.state)[cat3 == "GandT"]$fullname
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name >= 2, V(g.state)$fullname, NA),
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
V(g.state)[cat3 == "GandT"]$fullname
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name >= 3, NA, V(g.state)$fullname),
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
V(g.state)[cat3 == "GandT"]$fullname
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name > 2, NA, V(g.state)$fullname),
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
V(g.state)[cat3 == "GandT"]$fullname
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name > 1, NA, V(g.state)$fullname),
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
V(g.state)[cat3 == "GandT"]$fullname
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 1 |V(g.state)$name == 1, NA, V(g.state)$fullname),
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
V(g.state)[cat3 == "GandT"]$fullname
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 1 |V(g.state)$name == 2, NA, V(g.state)$fullname),
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
V(g.state)[cat3 == "GandT"]$fullname
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 1, V(g.state)$fullname, NA),
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
V(g.state)[cat3 == "GandT"]$fullname
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 1 | 2, V(g.state)$fullname, NA),
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
V(g.state)[cat3 == "GandT"]$fullname
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 2, V(g.state)$fullname, NA),
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
V(g.state)$name <= 2
V(g.state)$name >= 2
V(g.state)$name == 2
V(g.state)$name == 2 | V(g.state)$name == 1
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 2 | V(g.state)$name == 1, V(g.state)$fullname, NA),
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 2 | V(g.state)$name == 1,
V(g.state)$fullname, NA),
vertex.label.cex=.7,
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 2 | V(g.state)$name == 1,
V(g.state)$fullname, NA),
vertex.label.cex = .7,
vertex.label.color = "black",
vertex.label.dist = .7,
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 2 | V(g.state)$name == 1,
V(g.state)$fullname, NA),
vertex.label.cex = .7,
vertex.label.color = "black",
vertex.label.dist = 2,
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 2 | V(g.state)$name == 1,
V(g.state)$fullname, NA),
vertex.label.cex = .7,
vertex.label.color = "black",
vertex.label.dist = -2,
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 2 | V(g.state)$name == 1,
V(g.state)$fullname, NA),
vertex.label.cex = .7,
vertex.label.color = "black",
vertex.label.dist = -1.7,
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
par(mfrow=c(1,1), mar=c(0,4,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 2 | V(g.state)$name == 1,
V(g.state)$fullname, NA),
vertex.label.cex = .7,
vertex.label.color = "black",
vertex.label.dist = -1.7,
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 2 | V(g.state)$name == 1,
V(g.state)$fullname, NA),
vertex.label.cex = .7,
vertex.label.color = "black",
vertex.label.dist = -1.7,
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
par(mfrow=c(1,1), mar=c(2,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 2 | V(g.state)$name == 1,
V(g.state)$fullname, NA),
vertex.label.cex = .7,
vertex.label.color = "black",
vertex.label.dist = -1.7,
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
par(mfrow=c(1,1), mar=c(0,3,1,1))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 2 | V(g.state)$name == 1,
V(g.state)$fullname, NA),
vertex.label.cex = .7,
vertex.label.color = "black",
vertex.label.dist = -1.7,
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
par(mfrow=c(1,1), mar=c(0,3,1,3))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 2 | V(g.state)$name == 1,
V(g.state)$fullname, NA),
vertex.label.cex = .7,
vertex.label.color = "black",
vertex.label.dist = -1.7,
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
par(mfrow=c(1,1), mar=c(0,3,3,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 2 | V(g.state)$name == 1,
V(g.state)$fullname, NA),
vertex.label.cex = .7,
vertex.label.color = "black",
vertex.label.dist = -1.7,
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 2 | V(g.state)$name == 1,
V(g.state)$fullname, NA),
vertex.label.cex = .7,
vertex.label.color = "black",
vertex.label.dist = -1.7,
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 2 | V(g.state)$name == 1,
V(g.state)$fullname, NA),
vertex.label.cex = .7,
vertex.label.color = "black",
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 2 | V(g.state)$name == 1,
V(g.state)$fullname, NA),
vertex.label.cex = .7,
vertex.label.color = "blue",
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
sc_counties +
geom_sf(data = territories,
inherit.aes = FALSE, aes(fill = name),
alpha = .6) +
coord_sf(datum=NA) +
geom_point(aes(lon, lat, color = cat2),
data = coops %>%
filter(State == "SC") %>%
filter(cat1 == "First Tier" | cat2 == "Other" | cat2 == "Program"),
size = 3) +
geom_point(aes(lon, lat),
data = coops %>%
filter(State == "SC") %>%
filter(cat1 == "First Tier" | cat2 == "Other" | cat2 == "Program"),
size = 3, color = "black", stroke = 1,
shape = 21) +
guides(fill = "none", color = "legend") +
labs(title = "South Carolina Cooperative Service Territories", subtitle = "with Central Distribution Offices & Programs", color = "Node Type") +
theme_map()
par(mfrow=c(1,1), mar=c(0,3,1,0))
plot(g.gt,
layout = layout_components,
vertex.size = 14,
edge.arrow.size = .4,
vertex.color = rainbow(3)[factor(V(g.gt)$cat3)],
vertex.label = ifelse(V(g.state)$name == 2 | V(g.state)$name == 1,
V(g.state)$fullname, NA),
vertex.label.cex = .7,
vertex.label.color = "blue",
main = "South Carolina Electric Cooperative Network",
sub = "G&T and Distribution")
legend("bottomleft", legend = levels(factor(V(g.gt)$cat3)), col = rainbow(3),
pch = 16, bty = "n", title = "Node Type", inset=c(-0.1,0))
